% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FSEA.R
\name{FeatureSetEnrichmentAnalysis}
\alias{FeatureSetEnrichmentAnalysis}
\title{Feature Set Enrichment Analysis}
\usage{
FeatureSetEnrichmentAnalysis(object, view, feature.sets, factors = "all",
  local.statistic = c("loading", "cor", "z"),
  global.statistic = c("mean.diff", "rank.sum"),
  statistical.test = c("parametric", "cor.adj.parametric", "permutation"),
  transformation = c("abs.value", "none"), min.size = 10, nperm = 1000,
  cores = 1, p.adj.method = "BH", alpha = 0.1)
}
\arguments{
\item{object}{a \code{\link{MOFAmodel}} object.}

\item{view}{name of the view}

\item{feature.sets}{data structure that holds feature set membership information. Must be either a binary membership matrix (rows are feature sets and columns are features) or a list of feature set indexes (see vignette for details).}

\item{factors}{character vector with the factor names, or numeric vector with the index of the factors for which to perform the enrichment.}

\item{local.statistic}{the feature statistic used to quantify the association between each feature and each factor. Must be one of the following: loading (default), cor, z.}

\item{global.statistic}{the feature set statisic computed from the feature statistics. Must be one of the following: "mean.diff" (default) or "rank.sum".}

\item{statistical.test}{the statistical test used to compute the significance of the feature set statistics under a competitive null hypothesis.
Must be one of the following: "parametric" (default), "cor.adj.parametric", "permutation".}

\item{transformation}{optional transformation to apply to the feature-level statistics. Must be one of the following "none" or "abs.value" (default).}

\item{min.size}{Minimum size of a feature set (default is 10).}

\item{nperm}{number of permutations. Only relevant if statistical.test is set to "permutation". Default is 1000}

\item{cores}{number of cores to run the permutation analysis in parallel. Only relevant if statistical.test is set to "permutation". Default is 1}

\item{p.adj.method}{Method to adjust p-values factor-wise for multiple testing. Can be any method in p.adjust.methods(). Default uses Benjamini-Hochberg procedure.}

\item{alpha}{FDR threshold to generate lists of significant pathways. Default is 0.1}
}
\value{
a list with three components: pval and pval.adj contain matrices with p-values and adjusted p-values, repectively. sigPathways contains a list with significant pathwayd at FDR alpha per factor.
}
\description{
Method to perform feature set enrichment analysis. Here we use a slightly modified version of the \link[PCGSE]{pcgse} function.
}
\details{
TO-DO
}
\examples{
# Example on the CLL data
filepath <- system.file("extdata", "CLL_model.hdf5", package = "MOFAtools")
MOFA_CLL <- loadModel(filepath)
# perform FeatureSetEnrichmentAnalysis on mRNA data for all factors using the Reactome gene sets
data("reactomeGS")
fsea.out <- FeatureSetEnrichmentAnalysis(MOFA_CLL, view="mRNA", feature.sets=reactomeGS)
# results can be visualized using one of the following plotting functions:
# overview of enriched pathways per factor at an FDR of 1\%
Heatmap_FeatureSetEnrichmentAnalysis(fsea.out, alpha=0.01)
# overview of number of enriched pathways per factor at an FDR of 1\%
Barplot_FeatureSetEnrichmentAnalysis(fsea.out, alpha=0.01)
# e.g. top 10 enriched pathwyas on factor 5:
LinePlot_FeatureSetEnrichmentAnalysis(MOFA_CLL, fsea.out, factor=5,  max.pathways=10)
}
